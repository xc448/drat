<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Check and make corrections to pedigree — checkFam • PanelPRO</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Check and make corrections to pedigree — checkFam"><meta property="og:description" content="Check and make corrections to pedigree"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PanelPRO</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/building-pedigrees.html">Building PanelPRO Pedigrees</a>
    </li>
    <li>
      <a href="../articles/rcpp-functions.html">Rcpp Functions</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Check and make corrections to pedigree</h1>
    
    <div class="hidden name"><code>checkFam.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Check and make corrections to pedigree</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">checkFam</span><span class="op">(</span></span>
<span>  <span class="va">ped</span>,</span>
<span>  db <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  proband <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unknown.race <span class="op">=</span> <span class="va">UNKNOWN_RACE</span>,</span>
<span>  unknown.ancestry <span class="op">=</span> <span class="va">UNKNOWN_ANCESTRY</span>,</span>
<span>  ignore.proband.germ <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  allow.age.zero <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  impute.missing.ages <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  impute.times <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  max.iter.tries <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  random.seed <span class="op">=</span> <span class="fl">42L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ped</dt>
<dd><p>A pedigree data frame. (See the description of the <code>pedigree</code>
parameter in the <code><a href="PanelPRO.html">PanelPRO</a></code> master function documentation.)</p></dd>


<dt>db</dt>
<dd><p>A model-specific database returned by <code><a href="buildDatabase.html">buildDatabase</a></code>.
The default is <code>NULL</code>, in which case the database will be constructed based
on the cancer information encoded in <code>ped</code> and the genes in <code>GENE_TYPES</code>.</p></dd>


<dt>proband</dt>
<dd><p>A numeric value or vector of the unique IDs in <code>ped</code>
corresponding to the proband(s). The default is <code>NULL</code>, in which case
probands will be inferred from the <code>isProband</code> column in <code>ped</code>, if it exists
and is valid. Otherwise, the IDs in <code>proband</code> will override the contents of
<code>ped$isProband</code>. The user can also specify <code>proband = "All"</code>, in which case
all IDs in the <code>ped</code> will be treated as probands.</p></dd>


<dt>unknown.race</dt>
<dd><p>A character string indicating the default race to use
when <code>ped$race</code> is missing or unsupported. The default is
<code>PanelPRO:::UNKNOWN_RACE</code>.</p></dd>


<dt>unknown.ancestry</dt>
<dd><p>A character string indicating the default ancestry
to use when <code>ped$Ancestry</code> is missing or unsupported. The default is
<code>PanelPRO:::UNKNOWN_ANCESTRY</code>.</p></dd>


<dt>ignore.proband.germ</dt>
<dd><p>A logical value indicating if the proband(s)'s
germline testing results (if provided in <code>ped</code>) should be considered. The
default is <code>FALSE</code>, in which case the proband(s)'s germline testing results
will not be ignored.</p></dd>


<dt>allow.age.zero</dt>
<dd><p>A logical value indicating whether zero ages can be
reported in <code>ped</code>. The default is <code>FALSE</code>, in which case <code>0</code> values in age
columns will be treated as missing and imputed. <code>allow.age.zero</code> should only
be <code>TRUE</code> if individuals are confirmed to born with a cancer. Currently, the
<code>allow.age.zero = TRUE</code> is not supported behavior for the <code>PanelPRO</code> model
functions.</p></dd>


<dt>impute.missing.ages</dt>
<dd><p>A logical value indicating whether missing ages
should be multiply imputed. The default is <code>TRUE</code>. If set to <code>FALSE</code>, an
error will be raised if any individuals have missing current or cancer
affection ages.</p></dd>


<dt>impute.times</dt>
<dd><p>A numeric value indicating the number of iterations that
should be run when multiply imputing missing ages. The default is <code>20</code>.</p></dd>


<dt>max.iter.tries</dt>
<dd><p>A numeric value indicating the maximum number of
iterations that should be attempted when multiply imputing missing ages.
(Invalid iterations typically occur when an individual is missing both their
current and cancer ages. Current ages for living individuals are imputed
first; if a valid cancer affection cannot be found, subject to the upper
bound set by the imputed current age, this imputation run will be
discarded.) The default is <code>NULL</code>, in which case the maximum number of
tries will be set to five times <code>iterations</code>.</p></dd>


<dt>random.seed</dt>
<dd><p>The random seed (a numeric value) to set for imputing
missing ages. The default is <code>42L</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with three components:</p><ul><li><p><code>lms</code>: A nested list where each component corresponds to the imputed ages
for a connected pedigree in <code>ped_list</code>. Each component is itself a list
where each component is a matrix of imputed ages corresponding to <code>CurAge</code>
(if one or more individuals in <code>ped</code> is missing their current age) or
<code>AgeX</code>, where <code>X</code> is a cancer for which one or more individuals in <code>ped</code>
is missing the affection age. Each matrix has <code>impute_times</code> rows; the
column names are the IDs of the individuals for whom ages were imputed.</p></li>
<li><p><code>proband</code>: A numeric value or vector of the unique IDs in the pedigree
corresponding to the proband(s). If the <code>proband</code> argument was specified by
the user, the returned list component will be identical. Otherwise, the IDs
will correspond to individuals in the <code>ped</code> argument where
<code>ped$isProband == 1</code>.</p></li>
<li><p><code>ped_list</code>: A list where each element is a connected pedigree that is a
subset of the relatives in <code>ped</code>. Typically, <code>ped_list</code> has length <code>1</code>,
unless there are multiple probands who are related to multiple disconnected
pedigrees. Relatives who are not connected to the proband(s) will be removed.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>First, <code>checkFam</code> checks that all required columns in pedigree are present,
valid, and consistent, printing informative error/warning messages and
making corrections when possible. It also removes family members that are
not connected to the proband(s) and splits the pedigree into connected
sub-families, if necessary. For more details, see the
<code><a href="dot-pedStructureCheck.html">.pedStructureCheck</a></code> documentation.</p>
<p>Second, <code>checkFam</code> imputes missing current, cancer affection, and death
ages for relatives in <code>ped</code>, subject to age-bounding information. For more
details, see the <code><a href="ageImpute.html">ageImpute</a></code> documentation.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="dot-pedStructureCheck.html">.pedStructureCheck</a></code>, <code><a href="ageImpute.html">ageImpute</a></code></p>
<p>Other check: 
<code><a href="dot-boundAffectionAges.html">.boundAffectionAges</a>()</code>,
<code><a href="dot-checkGender.html">.checkGender</a>()</code>,
<code><a href="dot-checkHeredity.html">.checkHeredity</a>()</code>,
<code><a href="dot-checkMating.html">.checkMating</a>()</code>,
<code><a href="dot-checkTwins.html">.checkTwins</a>()</code>,
<code><a href="dot-findIDs.html">.findIDs</a>()</code>,
<code><a href="dot-fix_gender_cancer.html">.fix_gender_cancer</a>()</code>,
<code><a href="dot-getOtherRels.html">.getOtherRels</a>()</code>,
<code><a href="dot-getSpouses.html">.getSpouses</a>()</code>,
<code><a href="dot-pedStructureCheck.html">.pedStructureCheck</a>()</code>,
<code><a href="dot-removeDisconnected.html">.removeDisconnected</a>()</code></p>
<p>Other impute: 
<code><a href="dot-boundAgeFromRelatives.html">.boundAgeFromRelatives</a>()</code>,
<code><a href="dot-cancerAgeImpute.html">.cancerAgeImpute</a>()</code>,
<code><a href="dot-currentAgeImpute.html">.currentAgeImpute</a>()</code>,
<code><a href="dot-firstDegreeRelative.html">.firstDegreeRelative</a>()</code>,
<code><a href="dot-getAgeFromPed.html">.getAgeFromPed</a>()</code>,
<code><a href="dot-secondDegreeRelative.html">.secondDegreeRelative</a>()</code>,
<code><a href="ageImpute.html">ageImpute</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Build database for specific model configurations</span></span></span>
<span class="r-in"><span><span class="va">brcadb</span> <span class="op">&lt;-</span> <span class="fu"><a href="buildDatabase.html">buildDatabase</a></span><span class="op">(</span><span class="st">"BRCAPRO"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your model has 3 cancers - Breast, Ovarian, Contralateral and 2 genes - BRCA1_hetero_anyPV, BRCA2_hetero_anyPV.</span>
<span class="r-in"><span><span class="co"># Run pedigree checks and age imputations</span></span></span>
<span class="r-in"><span><span class="fu">checkFam</span><span class="op">(</span>ped <span class="op">=</span> <span class="va">test_fam_1</span>, db <span class="op">=</span> <span class="va">brcadb</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in .pedStructureCheck(ped, cancers = MS_cancers, proband = proband,     unknown.race = unknown.race, unknown.ancestry = unknown.ancestry,     ignore.proband.germ = ignore.proband.germ, allow.age.zero = allow.age.zero):</span> CBC cancer is required in model but cannot be found in the pedigree</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by BayesMendel Lab, Theo Huang, Gavin Lee, Jane Liang, Tom Madsen, Qing Zhang.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

