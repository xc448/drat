<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Impute missing ages in pedigree — ageImpute • PanelPRO</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Impute missing ages in pedigree — ageImpute"><meta property="og:description" content="Imputes missing current, cancer affection, and death ages for relatives in
ped, subject to age-bounding information."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PanelPRO</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/building-pedigrees.html">Building PanelPRO Pedigrees</a>
    </li>
    <li>
      <a href="../articles/rcpp-functions.html">Rcpp Functions</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Impute missing ages in pedigree</h1>
    
    <div class="hidden name"><code>ageImpute.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Imputes missing current, cancer affection, and death ages for relatives in
<code>ped</code>, subject to age-bounding information.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ageImpute</span><span class="op">(</span></span>
<span>  <span class="va">ped</span>,</span>
<span>  <span class="va">rel_l</span>,</span>
<span>  <span class="va">proband</span>,</span>
<span>  <span class="va">impute_times</span>,</span>
<span>  <span class="va">max_iter_tries</span>,</span>
<span>  <span class="va">penet_db</span>,</span>
<span>  dist_age <span class="op">=</span> <span class="va">AgeDistribution</span>,</span>
<span>  penet_cbc_db <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ped</dt>
<dd><p>A pedigree data frame returned by
<code><a href="dot-pedStructureCheck.html">.pedStructureCheck</a></code>.</p></dd>


<dt>rel_l</dt>
<dd><p>The list of relationships in <code>ped</code> returned by
<code><a href="dot-pedStructureCheck.html">.pedStructureCheck</a></code>.</p></dd>


<dt>proband</dt>
<dd><p>A numeric value or vector of the unique IDs in <code>ped</code>
corresponding to the proband(s).</p></dd>


<dt>impute_times</dt>
<dd><p>The number of iterations to be imputed for missing ages.</p></dd>


<dt>max_iter_tries</dt>
<dd><p>A numeric value indicating the maximum number of
iterations that should be attempted when multiply imputing missing ages.</p></dd>


<dt>penet_db</dt>
<dd><p>The cancer penetrances for carriers returned by
<code><a href="buildDatabase.html">buildDatabase</a></code> in the <code>penet$penet_c</code> list component.</p></dd>


<dt>dist_age</dt>
<dd><p>A list containing empirical distributions of female and male
ages at first birth; female and male birth ages; and sibling age
differences. The default is <code><a href="AgeDistribution.html">AgeDistribution</a></code>.</p></dd>


<dt>penet_cbc_db</dt>
<dd><p>A numeric array of contralateral cancer penetrance for
carriers returned by <code><a href="buildDatabase.html">buildDatabase</a></code> in the <code>penet$penet_cbc</code>
list component.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list where each component is a matrix of imputed ages
corresponding to <code>CurAge</code> (if one or more individuals in <code>ped</code> is missing
their current age) or <code>AgeX</code>, where <code>X</code> is a cancer for which one or more
individuals in <code>ped</code> is missing the affection age. Each matrix has
<code>impute_times</code> rows; the column names are the IDs of the individuals for
whom ages were imputed.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>First, we impute the missing censoring ages (stored as <code>ped$CurAge</code>) of
living first-degree relatives, followed by second-degree relatives and then
more distant relatives. If more than one proband is supplied, the first one
will be used to determine first- and second-degree relatives.</p>
<p>Within each group of relatives, we estimate current age bounds for each
individual (see <code><a href="dot-getAgeFromPed.html">.getAgeFromPed</a></code> documentation). The relative
with the narrowest age bound interval in the relative group has their
current age imputed first, from a normal distribution truncated by their age
bounds (see <code><a href="dot-currentAgeImpute.html">.currentAgeImpute</a></code>  documentation). The pedigree is
updated with this relative's imputed age and the age bounds are then
re-calculated for the remaining relatives in the relative group. This
process repeats until no living individuals with missing censoring ages are
left in the relative group.</p>
<p>After all missing censoring ages for living relatives have been imputed, we
impute missing cancer affection ages. For each missing age, the upper bound
is the minimum of the individual's censoring age, their upper bound for this
cancer's affection age, and <code>PanelPRO:::MAXAGE</code>; the lower bound is the
maximum of their lower bound for this cancer's affection age, their ages of
preventative interventions (if relevant), and <code>1</code>. The affection age is
then sampled based on the crude SEER cancer penetrance estimates (subset by
the individual's race and sex) within the age bounds (see
<code><a href="dot-cancerAgeImpute.html">.cancerAgeImpute</a></code> documentation). If a missing cancer age
cannot be sampled such that it satisfies its age bounds, this imputation run
will be discarded and re-attempted, with a warning message issued. If the
desired number of runs (<code>iterations</code>, default <code>20</code>) cannot be imputed within
<code>max.iter.tries</code> (default <code>5*iterations</code>) attempts, an error will be raised.</p>
<p>Finally, missing death ages (stored in <code>CurAge</code> in the pedigree) of
individuals who are affected for at least one cancer and/or reported at
least one intervention are imputed, using the maximum of their cancer and
intervention ages as the lower bound (see <code><a href="dot-currentAgeImpute.html">.currentAgeImpute</a></code>
documentation). If a lower imputation bound cannot be found using this
approach and the individual has children in the pedigree, we assign their
<code>CurAge</code> to be <code>15</code> plus the maximum difference in their living children's
ages in the current imputation. (If the individual has one or zero living
children, <code>CurAge</code> is simply set to <code>15</code>.) In cases where the individual
has no children in the pedigree, their <code>CurAge</code> is set to <code>1</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other impute: 
<code><a href="dot-boundAgeFromRelatives.html">.boundAgeFromRelatives</a>()</code>,
<code><a href="dot-cancerAgeImpute.html">.cancerAgeImpute</a>()</code>,
<code><a href="dot-currentAgeImpute.html">.currentAgeImpute</a>()</code>,
<code><a href="dot-firstDegreeRelative.html">.firstDegreeRelative</a>()</code>,
<code><a href="dot-getAgeFromPed.html">.getAgeFromPed</a>()</code>,
<code><a href="dot-secondDegreeRelative.html">.secondDegreeRelative</a>()</code>,
<code><a href="checkFam.html">checkFam</a>()</code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by BayesMendel Lab, Theo Huang, Gavin Lee, Jane Liang, Tom Madsen, Qing Zhang.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

